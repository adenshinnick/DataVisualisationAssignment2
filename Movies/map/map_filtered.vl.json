{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 1000,
  "height": 600,
  "projection": {"type": "equalEarth"},
  "params": [
    {
      "name": "selectedYear",
      "value": 2024,
      "bind": {
        "input": "range",
        "min": 1950,
        "max": 2024,
        "step": 1,
        "name": "Select Year: "
      }
    }
  ],
  "layer": [
    {
      "mark": {"type": "geoshape", "fill": "#e6f2ff", "stroke": null},
      "data": {"sphere": true}
    },
    {
      "mark": {"type": "geoshape", "fill": null, "stroke": "#cccccc", "strokeWidth": 0.4},
      "data": {"graticule": {"step": [20, 20]}}
    },
    {
      "data": {
        "url": "Movies/map/ne_110m (1).json",
        "format": {"type": "topojson", "feature": "ne_110m_admin_0_countries"}
      },
      "transform": [
        {
          "lookup": "properties.ISO_A3",
          "from": {
            "data": {"url": "Movies/map/country_movie_counts_wide_iso3.csv"},
            "key": "ISO_A3",
            "fields": [
              "1950","1951","1952","1953","1954","1955","1956","1957","1958","1959",
              "1960","1961","1962","1963","1964","1965","1966","1967","1968","1969",
              "1970","1971","1972","1973","1974","1975","1976","1977","1978","1979",
              "1980","1981","1982","1983","1984","1985","1986","1987","1988","1989",
              "1990","1991","1992","1993","1994","1995","1996","1997","1998","1999",
              "2000","2001","2002","2003","2004","2005","2006","2007","2008","2009",
              "2010","2011","2012","2013","2014","2015","2016","2017","2018","2019",
              "2020","2021","2022","2023","2024"
            ]
          },
          "default": 0
        },
        {"calculate": "datum[toString(selectedYear)]", "as": "movie_count"}
      ],
      "mark": {"type": "geoshape", "stroke": "#888", "strokeWidth": 0.4},
      "params": [
        {
          "name": "hoverSel",
          "select": {"type": "point", "on": "mouseover", "clear": "mouseout"}
        }
      ],
      "encoding": {
        "color": {
          "field": "movie_count",
          "type": "quantitative",
          "title": "Movies Produced",
          "scale": {"type": "log", "scheme": "blues", "domainMin": 1}
        },
        "tooltip": [
          {"field": "properties.NAME_EN", "title": "Country"},
          {"field": "movie_count", "title": "Movies", "format": ","}
        ],
        "strokeWidth": {
          "condition": {"param": "hoverSel", "empty": false, "value": 1.5},
          "value": 0.4
        },
        "stroke": {
          "condition": {"param": "hoverSel", "empty": false, "value": "black"},
          "value": "#888"
        }
      }
    },
    {
      "mark": {
        "type": "text",
        "align": "left",
        "x": 20,
        "y": 25,
        "fontSize": 14,
        "fontWeight": "bold",
        "color": "#333"
      }
     
    }
  ],
  "config": {
    "background": "transparent",
    "view": {"stroke": "transparent"},
    "legend": {"titleLimit": 150}
  }
}
